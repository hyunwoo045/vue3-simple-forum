import{createRouter,createWebHashHistory}from"vue-router";import Container from"./Container";import Add from"./Add";import Read from"./Read";import Login from"./Login";import Home from"./Home";import LoginSuccess from"./LoginSuccess";import store from"../store/index";import axios from"axios";import config from"~/key/config";const endpoint=config.endpoint;export default createRouter({history:createWebHashHistory(),routes:[{path:"/login",component:Login,name:"Login",beforeEnter:(o,e,t)=>{store.state.user.isLoggedIn?(alert("이미 로그인 되어 있습니다."),t("/")):t()}},{path:"/loginsuccess",component:LoginSuccess,name:"LoginSuccess"},{path:"/",component:Home,name:"Home",beforeEnter:(o,e,t)=>{store.state.user.isLoggedIn?t():(console.log("STORE NEED UPDATED"),axios.get(`${endpoint}/auth/session`).then((o=>{if("SESSION_EXPIRED"===o.data)alert("로그인이 필요합니다."),t("/login");else{const e=o.data;store.commit("user/setState",e),t()}})))},children:[{path:"",component:Container,name:"Container"},{path:"add",component:Add,name:"Add",props:!0},{path:"read",component:Read,name:"Read"}]}]});